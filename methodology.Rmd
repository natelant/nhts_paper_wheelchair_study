---
title: "Methodology"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# install.packages("devtools")
# devtools::install_github("byu-transpolab/nhts2017")
library(nhts2017)
library(tidyverse)
library(scales)

# for help understanding the kableExtra library 
# (https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html)
# there may be some issues with this table going to html vs pdf and latex
library(kableExtra)

library(Stack)
```

```{r function, include=F}
distributions <- function(data, variable){
  
  quote_var <- enquo(variable)
  
  data %>% 
  filter(Ability != "NA", 
         !!quote_var != "NA") %>%
  # Calculate number of people in each combination of income and ability.
  group_by(Ability, !!quote_var) %>%
  summarise(population = sum(wtperfin)) %>%
  mutate(Population = population,
        `Distribution(%)` = 
          percent(population/sum(population), 
                   accuracy = 0.1),
        Variable = as.character(!!quote_var)) %>%
  select(Ability, Variable, `Distribution(%)`) %>%
  spread(Ability, `Distribution(%)`)
  
}
```

This section describes the data taken from the 2017 NHTS, the variables in the model, the respective 
distribution of each population, the



```{r code.table}
# This table will show all the variables useful for the regression model and show the distribution for each 
# of the populations: Abled, Disabled, Wheelchair

# the final.rds data has the full grid with all of the trip purpose tally per person (in addition to the 
# entire persons attribute file)
my_data <- read_rds("data/nhts_data.rds")

age <- distributions(my_nhts, Age)
income <- distributions(my_nhts, Income)
work <- distributions(my_nhts, Worker)

# now the stacking part. only one at a time please :)
Stack(age, income) %>% 
  Stack(work) %>%
  
  # pipe into the kable function
  kable(caption = "Data Distribution") %>%
  kable_styling("striped", full_width = F) %>%
  pack_rows("Age", 1, 10) %>%
  pack_rows("Income", 11, 14) %>%
  pack_rows("Worker Status", 15, 17)
```

